<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>BPHYLIB: PIC Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>PIC Class Reference</h1><!-- doxytag: class="PIC" --><a class="el" href="structParticle.html" title="3D particle structure.">Particle</a> container.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="pic_8h-source.html">pic.h</a>&gt;</code>
<p>

<p>
<a href="classPIC-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="adb5e6fdbb47fa97b17aa5b794774669"></a><!-- doxytag: member="PIC::PIC" ref="adb5e6fdbb47fa97b17aa5b794774669" args="(double macro, double q, double m, double len, int n)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>PIC</b> (double macro, double q, double m, double len, int n)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d1bd46237afec99f7c0de61aec05b65b"></a><!-- doxytag: member="PIC::get_size" ref="d1bd46237afec99f7c0de61aec05b65b" args="()" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>get_size</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e1b92ccff08c9edcbeefa3c53e70287e"></a><!-- doxytag: member="PIC::get_macro" ref="e1b92ccff08c9edcbeefa3c53e70287e" args="()" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>get_macro</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="692b8d63a96ca657bcfb155c287bf4f5"></a><!-- doxytag: member="PIC::set_macro" ref="692b8d63a96ca657bcfb155c287bf4f5" args="(double macro)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>set_macro</b> (double macro)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ee01f0cf91916407ce75c86a0448c41d"></a><!-- doxytag: member="PIC::get_m" ref="ee01f0cf91916407ce75c86a0448c41d" args="()" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>get_m</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="78c0e1d860577164e9917118ca83b997"></a><!-- doxytag: member="PIC::get_q" ref="78c0e1d860577164e9917118ca83b997" args="()" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>get_q</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="011202f3bedc77ef6fdb9bb224a29b25"></a><!-- doxytag: member="PIC::get_gamma" ref="011202f3bedc77ef6fdb9bb224a29b25" args="(int j)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>get_gamma</b> (int j)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="87f59482680ff11985aa29f54c3251ac"></a><!-- doxytag: member="PIC::get_vx" ref="87f59482680ff11985aa29f54c3251ac" args="(int j)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>get_vx</b> (int j)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c069d637e0ef1b476725f0e10398380f"></a><!-- doxytag: member="PIC::get_vy" ref="c069d637e0ef1b476725f0e10398380f" args="(int j)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>get_vy</b> (int j)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6360bd0477f048ff380d5f3ea7741cb6"></a><!-- doxytag: member="PIC::get_vz" ref="6360bd0477f048ff380d5f3ea7741cb6" args="(int j)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>get_vz</b> (int j)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="085d3f5f08fb45269cc8a1b738d9de00"></a><!-- doxytag: member="PIC::get_energy" ref="085d3f5f08fb45269cc8a1b738d9de00" args="(int j)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPIC.html#085d3f5f08fb45269cc8a1b738d9de00">get_energy</a> (int j)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">kinetic energy in eV <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="078b923c632faef2f9f7bd3797959414"></a><!-- doxytag: member="PIC::get_x" ref="078b923c632faef2f9f7bd3797959414" args="(int j)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>get_x</b> (int j)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5f694f5efb8d989fd49bb92b7cc1188e"></a><!-- doxytag: member="PIC::get_y" ref="5f694f5efb8d989fd49bb92b7cc1188e" args="(int j)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>get_y</b> (int j)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d50e99e0837c606398370e650653c940"></a><!-- doxytag: member="PIC::get_z" ref="d50e99e0837c606398370e650653c940" args="(int j)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>get_z</b> (int j)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="9a99541733336d149b1407c67c092378"></a><!-- doxytag: member="PIC::set_const_density_xy" ref="9a99541733336d149b1407c67c092378" args="(double boundary, double T0, long *d1)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>set_const_density_xy</b> (double boundary, double T0, long *d1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPIC.html#db899bb391128b96632d4a2aa326b41a">inject_beam</a> (double boundary, double vel, double angle, double ndensity, double Tempxy, double Tempz, double dt, long *d1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPIC.html#68c4a3a93540efd76ceb2ae18412b585">shift_xyz</a> (double dt, double boundary)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPIC.html#fb7a48b9a158a2d95f924678240a6fb6">shift_xyz</a> (double dt, double boundary, double delta_max, double Emax, double E0, long *d1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f8f9f504a2046409fc8756cab1653528"></a><!-- doxytag: member="PIC::shift_uxy" ref="f8f9f504a2046409fc8756cab1653528" args="(Grid2D &amp;pot, double dt)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>shift_uxy</b> (<a class="el" href="classGrid2D.html">Grid2D</a> &amp;pot, double dt)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ef6019e2d466a06112b65beaa24b9129"></a><!-- doxytag: member="PIC::shift_urz" ref="ef6019e2d466a06112b65beaa24b9129" args="(Grid2D_rz &amp;pot, double dt)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>shift_urz</b> (Grid2D_rz &amp;pot, double dt)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPIC.html#4156f1201462b4aa06aaa4c85d8a3dd5">Boris_uxy</a> (double By, double dt)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPIC.html#82d00e6b66c67491365a66199fe13f8e">Boris_uxy</a> (<a class="el" href="classGrid2D.html">Grid2D</a> &amp;Bx, <a class="el" href="classGrid2D.html">Grid2D</a> &amp;By, double dt)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPIC.html#40784574a094f98cbd95fd3729f1ca3b">Boris_urz</a> (Grid2D_rz &amp;Br, Grid2D_rz &amp;Bz, double dt)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b00af391d1bd0dc7f032ae6a17d3bc38"></a><!-- doxytag: member="PIC::get_potential_xy" ref="b00af391d1bd0dc7f032ae6a17d3bc38" args="(Grid2D &amp;pote, Grid2D &amp;rhoe, Greenfb &amp;gf)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>get_potential_xy</b> (<a class="el" href="classGrid2D.html">Grid2D</a> &amp;pote, <a class="el" href="classGrid2D.html">Grid2D</a> &amp;rhoe, Greenfb &amp;gf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="09c04eae0da089b390fdf817883582b6"></a><!-- doxytag: member="PIC::get_potential_rz" ref="09c04eae0da089b390fdf817883582b6" args="(Grid2D_rz &amp;pote, Grid2D_rz &amp;rhoe)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>get_potential_rz</b> (Grid2D_rz &amp;pote, Grid2D_rz &amp;rhoe)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="89f092d5a6b3eede4fc23f09d441cacf"></a><!-- doxytag: member="PIC::densityXY" ref="89f092d5a6b3eede4fc23f09d441cacf" args="(Grid2D &amp;target)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>densityXY</b> (<a class="el" href="classGrid2D.html">Grid2D</a> &amp;target)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0f7f3dd6d62e3c0035fdddc9aa201c63"></a><!-- doxytag: member="PIC::densityRZ" ref="0f7f3dd6d62e3c0035fdddc9aa201c63" args="(Grid2D_rz &amp;target)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>densityRZ</b> (Grid2D_rz &amp;target)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3ebd0467ee2dad2f2470407c8e4f2d21"></a><!-- doxytag: member="PIC::Tx_rms" ref="3ebd0467ee2dad2f2470407c8e4f2d21" args="()" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>Tx_rms</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="09b7e045d6c8550a2ec2dbe6f9457527"></a><!-- doxytag: member="PIC::vth_xy" ref="09b7e045d6c8550a2ec2dbe6f9457527" args="()" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>vth_xy</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c2fc2092eccca66f2952f695e485fc6b"></a><!-- doxytag: member="PIC::x_rms" ref="c2fc2092eccca66f2952f695e485fc6b" args="()" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>x_rms</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d2626159532193029b2ab0fa754f3f01"></a><!-- doxytag: member="PIC::offset_x" ref="d2626159532193029b2ab0fa754f3f01" args="()" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>offset_x</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b2a40f975249f0a83cd521a60705c8f8"></a><!-- doxytag: member="PIC::offset_y" ref="b2a40f975249f0a83cd521a60705c8f8" args="()" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>offset_y</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="723bc3559cf15bb0638fab9c453b5dde"></a><!-- doxytag: member="PIC::total_charge" ref="723bc3559cf15bb0638fab9c453b5dde" args="()" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>total_charge</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6f38522b145b9f16bb451352b72dd287"></a><!-- doxytag: member="PIC::total_kinetic_energy" ref="6f38522b145b9f16bb451352b72dd287" args="()" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>total_kinetic_energy</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="eb2c3ae81ea72c37159f39434bf0b202"></a><!-- doxytag: member="PIC::total_energy" ref="eb2c3ae81ea72c37159f39434bf0b202" args="(Grid2D &amp;pot)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>total_energy</b> (<a class="el" href="classGrid2D.html">Grid2D</a> &amp;pot)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="14288313fc816bffcc7ecd94cba8a735"></a><!-- doxytag: member="PIC::reflection" ref="14288313fc816bffcc7ecd94cba8a735" args="(double energy, double E0, long *d)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>reflection</b> (double energy, double E0, long *d)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f8a4fef9f404ea34d1ebe91751500597"></a><!-- doxytag: member="PIC::secondary" ref="f8a4fef9f404ea34d1ebe91751500597" args="(double energy, double delta_max, double Emax, long *d)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>secondary</b> (double energy, double delta_max, double Emax, long *d)</td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8939fec31c7e6e6806dbfc74e41e9317"></a><!-- doxytag: member="PIC::part" ref="8939fec31c7e6e6806dbfc74e41e9317" args="" -->
vector&lt; <a class="el" href="structParticle.html">Particle</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>part</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="300c02241819293ec5184bf4aa2ae2c9"></a><!-- doxytag: member="PIC::macroN" ref="300c02241819293ec5184bf4aa2ae2c9" args="" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPIC.html#300c02241819293ec5184bf4aa2ae2c9">macroN</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">number of physical particles per macro particle <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ea1d15fedb91fab437f53cde03f9ae4a"></a><!-- doxytag: member="PIC::charge_p" ref="ea1d15fedb91fab437f53cde03f9ae4a" args="" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>charge_p</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="99e18e7f4ab625cdd446b5b2f9e2e56a"></a><!-- doxytag: member="PIC::mass_p" ref="99e18e7f4ab625cdd446b5b2f9e2e56a" args="" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPIC.html#99e18e7f4ab625cdd446b5b2f9e2e56a">mass_p</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">particle charge and charge numbers <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="55fc160bed52250126a334a3e4b93087"></a><!-- doxytag: member="PIC::length" ref="55fc160bed52250126a334a3e4b93087" args="" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPIC.html#55fc160bed52250126a334a3e4b93087">length</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">length of the missing dimension; <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<a class="el" href="structParticle.html" title="3D particle structure.">Particle</a> container. 
<p>Definition at line <a class="el" href="pic_8h-source.html#l00012">12</a> of file <a class="el" href="pic_8h-source.html">pic.h</a>.</p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="db899bb391128b96632d4a2aa326b41a"></a><!-- doxytag: member="PIC::inject_beam" ref="db899bb391128b96632d4a2aa326b41a" args="(double boundary, double vel, double angle, double ndensity, double Tempxy, double Tempz, double dt, long *d1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PIC::inject_beam           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>ndensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>Tempxy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>Tempz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&nbsp;</td>
          <td class="paramname"> <em>d1</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
inject beam 
<p>Definition at line <a class="el" href="pic_8cpp-source.html#l00040">40</a> of file <a class="el" href="pic_8cpp-source.html">pic.cpp</a>.</p>

<p>References <a class="el" href="pic_8h-source.html#l00019">length</a>, <a class="el" href="pic_8h-source.html#l00017">macroN</a>, <a class="el" href="pic_8h-source.html#l00018">mass_p</a>, <a class="el" href="pic_8h-source.html#l00006">Particle::ux</a>, <a class="el" href="pic_8h-source.html#l00006">Particle::uy</a>, <a class="el" href="pic_8h-source.html#l00006">Particle::uz</a>, <a class="el" href="pic_8h-source.html#l00004">Particle::x</a>, <a class="el" href="pic_8h-source.html#l00004">Particle::y</a>, and <a class="el" href="pic_8h-source.html#l00004">Particle::z</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00041"></a>00041 {
<a name="l00042"></a>00042  <span class="keywordtype">double</span> Ninj=vel*ndensity*PI*pow(boundary,2)*dt/<a class="code" href="classPIC.html#300c02241819293ec5184bf4aa2ae2c9" title="number of physical particles per macro particle">macroN</a>; 
<a name="l00043"></a>00043  <span class="keywordtype">double</span> gamma=1.0/sqrt(1.0-pow(vel/clight,2));
<a name="l00044"></a>00044  <span class="keywordtype">double</span> utherm=clight*sqrt(pow(charge_p*Tempxy/(<a class="code" href="classPIC.html#99e18e7f4ab625cdd446b5b2f9e2e56a" title="particle charge and charge numbers">mass_p</a>*clight*clight)+1.0,2)-1.0);
<a name="l00045"></a>00045  <span class="keywordtype">double</span> r_amp, phase;
<a name="l00046"></a>00046  <span class="keywordtype">double</span> u, v, w;
<a name="l00047"></a>00047  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;Ninj; j++) 
<a name="l00048"></a>00048    { 
<a name="l00049"></a>00049         <a class="code" href="structParticle.html" title="3D particle structure.">Particle</a> part_inj;
<a name="l00050"></a>00050         r_amp=boundary*sqrt(ran1(d1));
<a name="l00051"></a>00051         phase=2.0*PI*ran1(d1);  
<a name="l00052"></a>00052         part_inj.<a class="code" href="structParticle.html#1e3e5e103cee69ae9acb9c3269d009d7" title="x, y, z positions. x,y: Transverse coordinates. z: longitudinal">x</a>=r_amp*cos(phase);
<a name="l00053"></a>00053         part_inj.<a class="code" href="structParticle.html#434ab690dde4422ac74ae10f6ace7a52">y</a>=r_amp*sin(phase);
<a name="l00054"></a>00054         part_inj.<a class="code" href="structParticle.html#518399a50ebdd632b22d7f48e5958461">z</a>=-0.5*<a class="code" href="classPIC.html#55fc160bed52250126a334a3e4b93087" title="length of the missing dimension;">length</a>;
<a name="l00055"></a>00055         
<a name="l00056"></a>00056         <span class="keywordflow">do</span> { u = 2.0 * ran1(d1) - 1.0 ;  
<a name="l00057"></a>00057              v = 2.0 * ran1(d1) - 1.0 ;              
<a name="l00058"></a>00058              w = u*u + v*v ; }
<a name="l00059"></a>00059              <span class="keywordflow">while</span> (w &gt;= 1.0) ;
<a name="l00060"></a>00060         
<a name="l00061"></a>00061         part_inj.<a class="code" href="structParticle.html#61e44eaba00b1a96436986e0737e8724" title="x, y, z velocities.">ux</a> = part_inj.<a class="code" href="structParticle.html#1e3e5e103cee69ae9acb9c3269d009d7" title="x, y, z positions. x,y: Transverse coordinates. z: longitudinal">x</a>/r_amp*vel*angle + utherm * u * sqrt(-2.0*log(w)/w) ;
<a name="l00062"></a>00062         part_inj.<a class="code" href="structParticle.html#3c67ede486b04af4d5f834072defa5c8">uy</a> = part_inj.<a class="code" href="structParticle.html#434ab690dde4422ac74ae10f6ace7a52">y</a>/r_amp*vel*angle + utherm * v * sqrt(-2.0*log(w)/w) ;
<a name="l00063"></a>00063         part_inj.<a class="code" href="structParticle.html#89a3f7cacc8bd0250855e8a07bebd645">uz</a> = gamma*vel;
<a name="l00064"></a>00064     part.push_back(part_inj);
<a name="l00065"></a>00065    }    
<a name="l00066"></a>00066 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="68c4a3a93540efd76ceb2ae18412b585"></a><!-- doxytag: member="PIC::shift_xyz" ref="68c4a3a93540efd76ceb2ae18412b585" args="(double dt, double boundary)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PIC::shift_xyz           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>boundary</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
coordinate shift with absorbing boundary 
<p>Definition at line <a class="el" href="pic_8cpp-source.html#l00104">104</a> of file <a class="el" href="pic_8cpp-source.html">pic.cpp</a>.</p>

<p>References <a class="el" href="pic_8h-source.html#l00019">length</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00105"></a>00105 {
<a name="l00106"></a>00106   <span class="keywordtype">long</span> j;
<a name="l00107"></a>00107   <span class="keywordtype">double</span> gamma, u2;
<a name="l00108"></a>00108   <span class="keywordflow">for</span>(j=0; j&lt;part.size(); j++)
<a name="l00109"></a>00109    {
<a name="l00110"></a>00110         u2=pow(part[j].uy,2)+pow(part[j].ux,2)+pow(part[j].uz,2);
<a name="l00111"></a>00111         gamma=sqrt(1.0+u2/pow(clight,2));
<a name="l00112"></a>00112         part[j].x+=part[j].ux*dt/gamma;
<a name="l00113"></a>00113         part[j].y+=part[j].uy*dt/gamma; 
<a name="l00114"></a>00114         part[j].z+=part[j].uz*dt/gamma;
<a name="l00115"></a>00115         <span class="keywordflow">if</span> ( sqrt(pow(part[j].x,2)+pow(part[j].y,2)) &gt; boundary || part[j].z &gt; 0.5*<a class="code" href="classPIC.html#55fc160bed52250126a334a3e4b93087" title="length of the missing dimension;">length</a> || part[j].z &lt; -0.5*<a class="code" href="classPIC.html#55fc160bed52250126a334a3e4b93087" title="length of the missing dimension;">length</a> )
<a name="l00116"></a>00116           part.erase(part.begin()+j);
<a name="l00117"></a>00117           
<a name="l00118"></a>00118    }
<a name="l00119"></a>00119 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="fb7a48b9a158a2d95f924678240a6fb6"></a><!-- doxytag: member="PIC::shift_xyz" ref="fb7a48b9a158a2d95f924678240a6fb6" args="(double dt, double boundary, double delta_max, double Emax, double E0, long *d1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PIC::shift_xyz           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>delta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>Emax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>E0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&nbsp;</td>
          <td class="paramname"> <em>d1</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
coordinate shift with SEY at boundary 
<p>Definition at line <a class="el" href="pic_8cpp-source.html#l00125">125</a> of file <a class="el" href="pic_8cpp-source.html">pic.cpp</a>.</p>

<p>References <a class="el" href="pic_8h-source.html#l00037">get_energy()</a>, <a class="el" href="pic_8h-source.html#l00017">macroN</a>, <a class="el" href="pic_8h-source.html#l00018">mass_p</a>, <a class="el" href="pic_8h-source.html#l00006">Particle::ux</a>, <a class="el" href="pic_8h-source.html#l00006">Particle::uy</a>, <a class="el" href="pic_8h-source.html#l00006">Particle::uz</a>, <a class="el" href="pic_8h-source.html#l00004">Particle::x</a>, <a class="el" href="pic_8h-source.html#l00004">Particle::y</a>, and <a class="el" href="pic_8h-source.html#l00004">Particle::z</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00126"></a>00126 {
<a name="l00127"></a>00127   <span class="keywordtype">long</span> j;
<a name="l00128"></a>00128   <span class="keywordtype">int</span> ref=0, sec=0;
<a name="l00129"></a>00129   <span class="keywordtype">double</span> gamma, u2, r2;
<a name="l00130"></a>00130   <span class="keywordtype">double</span> T0=2.0, phi_emit=0.0, energy=0.0;
<a name="l00131"></a>00131   <span class="keywordtype">double</span> ut=clight*sqrt(pow(fabs(charge_p)*T0/(<a class="code" href="classPIC.html#99e18e7f4ab625cdd446b5b2f9e2e56a" title="particle charge and charge numbers">mass_p</a>*clight*clight)+1.0,2)-1.0);
<a name="l00132"></a>00132   vector&lt;Particle&gt; part_new; 
<a name="l00133"></a>00133   <span class="keywordflow">for</span>(j=0; j&lt;part.size(); j++)
<a name="l00134"></a>00134    {
<a name="l00135"></a>00135         u2=pow(part[j].uy,2)+pow(part[j].ux,2)+pow(part[j].uz,2);
<a name="l00136"></a>00136         gamma=sqrt(1.0+u2/pow(clight,2));
<a name="l00137"></a>00137         part[j].x+=part[j].ux*dt/gamma;
<a name="l00138"></a>00138         part[j].y+=part[j].uy*dt/gamma;
<a name="l00139"></a>00139     r2=pow(part[j].y,2)+pow(part[j].x,2);
<a name="l00140"></a>00140         <span class="keywordflow">if</span> ( sqrt(r2) &gt; boundary ) 
<a name="l00141"></a>00141           {
<a name="l00142"></a>00142            ref=reflection(<a class="code" href="classPIC.html#085d3f5f08fb45269cc8a1b738d9de00" title="kinetic energy in eV">get_energy</a>(j),E0,d1);
<a name="l00143"></a>00143            <span class="keywordflow">if</span> (delta_max &gt; 0.0) sec=secondary(<a class="code" href="classPIC.html#085d3f5f08fb45269cc8a1b738d9de00" title="kinetic energy in eV">get_energy</a>(j),delta_max,Emax,d1); 
<a name="l00144"></a>00144            <span class="keywordflow">if</span> ( ref == 1)
<a name="l00145"></a>00145                 { 
<a name="l00146"></a>00146                      <span class="comment">//phi_emit=0.5*PI*(2.0*ran1(d1)-1.0);</span>
<a name="l00147"></a>00147                          <span class="comment">//part[j].ux=-ut*(cos(phi_emit)*part[j].x/sqrt(r2)-sin(phi_emit)*part[j].y/sqrt(r2));</span>
<a name="l00148"></a>00148                          <span class="comment">//part[j].uy=-ut*(sin(phi_emit)*part[j].y/sqrt(r2)+cos(phi_emit)*part[j].y/sqrt(r2));</span>
<a name="l00149"></a>00149                      part[j].ux=-part[j].ux;
<a name="l00150"></a>00150                      part[j].uy=-part[j].uy;
<a name="l00151"></a>00151                      part[j].x=0.99*boundary*part[j].x/sqrt(r2);  
<a name="l00152"></a>00152                          part[j].y=0.99*boundary*part[j].y/sqrt(r2);
<a name="l00153"></a>00153                     } 
<a name="l00154"></a>00154            <span class="keywordflow">else</span> { 
<a name="l00155"></a>00155                      <span class="keywordflow">if</span> (sec == 0) 
<a name="l00156"></a>00156                        {        
<a name="l00157"></a>00157                                 energy+=<a class="code" href="classPIC.html#085d3f5f08fb45269cc8a1b738d9de00" title="kinetic energy in eV">get_energy</a>(j);
<a name="l00158"></a>00158                         part.erase(part.begin()+j);
<a name="l00159"></a>00159                        }
<a name="l00160"></a>00160                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sec == 1)
<a name="l00161"></a>00161                   { 
<a name="l00162"></a>00162                        energy+=<a class="code" href="classPIC.html#085d3f5f08fb45269cc8a1b738d9de00" title="kinetic energy in eV">get_energy</a>(j);
<a name="l00163"></a>00163                            phi_emit=0.1*PI*(2.0*ran1(d1)-1.0);
<a name="l00164"></a>00164                            part[j].ux=-ut*(cos(phi_emit)*part[j].x/sqrt(r2)-sin(phi_emit)*part[j].y/sqrt(r2));
<a name="l00165"></a>00165                            part[j].uy=-ut*(sin(phi_emit)*part[j].y/sqrt(r2)+cos(phi_emit)*part[j].y/sqrt(r2));
<a name="l00166"></a>00166                        part[j].x=0.99*boundary*part[j].x/sqrt(r2);  
<a name="l00167"></a>00167                            part[j].y=0.99*boundary*part[j].y/sqrt(r2);  
<a name="l00168"></a>00168                       }
<a name="l00169"></a>00169                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sec == 2)
<a name="l00170"></a>00170                   { 
<a name="l00171"></a>00171                        energy+=<a class="code" href="classPIC.html#085d3f5f08fb45269cc8a1b738d9de00" title="kinetic energy in eV">get_energy</a>(j);
<a name="l00172"></a>00172                        <a class="code" href="structParticle.html" title="3D particle structure.">Particle</a> part_inj;
<a name="l00173"></a>00173                        phi_emit=0.1*PI*(2.0*ran1(d1)-1.0);
<a name="l00174"></a>00174                        part[j].ux=-ut*(cos(phi_emit)*part[j].x/sqrt(r2)-sin(phi_emit)*part[j].y/sqrt(r2));
<a name="l00175"></a>00175                        part[j].uy=-ut*(sin(phi_emit)*part[j].y/sqrt(r2)+cos(phi_emit)*part[j].y/sqrt(r2));
<a name="l00176"></a>00176                        phi_emit=0.1*PI*(2.0*ran1(d1)-1.0);
<a name="l00177"></a>00177                        part_inj.ux = -ut*(cos(phi_emit)*part[j].x/sqrt(r2)-sin(phi_emit)*part[j].y/sqrt(r2));
<a name="l00178"></a>00178                            part_inj.uy = -ut*(sin(phi_emit)*part[j].y/sqrt(r2)+cos(phi_emit)*part[j].y/sqrt(r2));
<a name="l00179"></a>00179                        part_inj.uz = 0.0;
<a name="l00180"></a>00180                        part[j].x=0.99*boundary*part[j].x/sqrt(r2);  
<a name="l00181"></a>00181                            part[j].y=0.99*boundary*part[j].y/sqrt(r2);  
<a name="l00182"></a>00182                        part_inj.x = part[j].x;
<a name="l00183"></a>00183                            part_inj.y = part[j].y; 
<a name="l00184"></a>00184                            part_inj.z = part[j].z;
<a name="l00185"></a>00185                            part_new.push_back(part_inj);
<a name="l00186"></a>00186                      }
<a name="l00187"></a>00187                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sec == 3)
<a name="l00188"></a>00188                  { 
<a name="l00189"></a>00189                        energy+=<a class="code" href="classPIC.html#085d3f5f08fb45269cc8a1b738d9de00" title="kinetic energy in eV">get_energy</a>(j);
<a name="l00190"></a>00190                            <a class="code" href="structParticle.html" title="3D particle structure.">Particle</a> part_inj, part_inj_2;
<a name="l00191"></a>00191                            phi_emit=0.1*PI*(2.0*ran1(d1)-1.0);
<a name="l00192"></a>00192                        part[j].ux=-ut*(cos(phi_emit)*part[j].x/sqrt(r2)-sin(phi_emit)*part[j].y/sqrt(r2));
<a name="l00193"></a>00193                        part[j].uy=-ut*(sin(phi_emit)*part[j].y/sqrt(r2)+cos(phi_emit)*part[j].y/sqrt(r2));
<a name="l00194"></a>00194                        phi_emit=0.1*PI*(2.0*ran1(d1)-1.0);
<a name="l00195"></a>00195                        part_inj.ux = -ut*(cos(phi_emit)*part[j].x/sqrt(r2)-sin(phi_emit)*part[j].y/sqrt(r2));
<a name="l00196"></a>00196                            part_inj.uy = -ut*(sin(phi_emit)*part[j].y/sqrt(r2)+cos(phi_emit)*part[j].y/sqrt(r2));
<a name="l00197"></a>00197                        part_inj.uz = 0.0;
<a name="l00198"></a>00198                        phi_emit=0.1*PI*(2.0*ran1(d1)-1.0);
<a name="l00199"></a>00199                            part_inj_2.ux = -ut*(cos(phi_emit)*part[j].x/sqrt(r2)-sin(phi_emit)*part[j].y/sqrt(r2));
<a name="l00200"></a>00200                            part_inj_2.uy = -ut*(sin(phi_emit)*part[j].y/sqrt(r2)+cos(phi_emit)*part[j].y/sqrt(r2));
<a name="l00201"></a>00201                        part_inj_2.uz = 0.0;
<a name="l00202"></a>00202                        part[j].x=0.99*boundary*part[j].x/sqrt(r2);  
<a name="l00203"></a>00203                            part[j].y=0.99*boundary*part[j].y/sqrt(r2);  
<a name="l00204"></a>00204                        part_inj.x = part[j].x;
<a name="l00205"></a>00205                            part_inj.y = part[j].y; 
<a name="l00206"></a>00206                            part_inj.z = part[j].z;
<a name="l00207"></a>00207                            part_inj_2.x = part[j].x;
<a name="l00208"></a>00208                            part_inj_2.y = part[j].y; 
<a name="l00209"></a>00209                            part_inj_2.z = part[j].z;
<a name="l00210"></a>00210                            part_new.push_back(part_inj);
<a name="l00211"></a>00211                            part_new.push_back(part_inj_2);
<a name="l00212"></a>00212                      }
<a name="l00213"></a>00213                         <span class="keywordflow">else</span> {cout &lt;&lt; <span class="stringliteral">"shift_xyz: n&gt;4"</span> &lt;&lt; endl; exit(0);}
<a name="l00214"></a>00214                     }
<a name="l00215"></a>00215           }     
<a name="l00216"></a>00216    }
<a name="l00217"></a>00217    <span class="keywordflow">for</span>(j=0; j&lt;part_new.size(); j++)
<a name="l00218"></a>00218             part.push_back(part_new[j]);
<a name="l00219"></a>00219         <span class="keywordflow">return</span> <a class="code" href="classPIC.html#300c02241819293ec5184bf4aa2ae2c9" title="number of physical particles per macro particle">macroN</a>*energy;
<a name="l00220"></a>00220 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="4156f1201462b4aa06aaa4c85d8a3dd5"></a><!-- doxytag: member="PIC::Boris_uxy" ref="4156f1201462b4aa06aaa4c85d8a3dd5" args="(double By, double dt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PIC::Boris_uxy           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>By</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>dt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Boris particle updater for a pure dipole B-field in y-direction. The push is done in 3D cartesian coordinates. 
<p>Definition at line <a class="el" href="pic_8cpp-source.html#l00296">296</a> of file <a class="el" href="pic_8cpp-source.html">pic.cpp</a>.</p>

<p>References <a class="el" href="pic_8h-source.html#l00018">mass_p</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00297"></a>00297 {
<a name="l00298"></a>00298  <span class="keywordtype">long</span> j;        
<a name="l00299"></a>00299  <span class="keywordtype">double</span> ty, tabs2, u2, gamma, ux0, uy0, uz0;    
<a name="l00300"></a>00300  <span class="keywordflow">for</span>(j=0; j&lt;part.size(); j++)
<a name="l00301"></a>00301    { 
<a name="l00302"></a>00302         u2=pow(part[j].uy,2)+pow(part[j].ux,2)+pow(part[j].uz,2);
<a name="l00303"></a>00303         gamma=sqrt(1.0+u2/pow(clight,2));
<a name="l00304"></a>00304         ux0=part[j].ux;uy0=part[j].uy;uz0=part[j].uz;
<a name="l00305"></a>00305         ty=By/fabs(By)*tan(charge_p*dt*fabs(By)/(2.0*gamma*<a class="code" href="classPIC.html#99e18e7f4ab625cdd446b5b2f9e2e56a" title="particle charge and charge numbers">mass_p</a>));
<a name="l00306"></a>00306         
<a name="l00307"></a>00307         tabs2=pow(ty,2); 
<a name="l00308"></a>00308         
<a name="l00309"></a>00309         part[j].ux+=-part[j].uz*ty;
<a name="l00310"></a>00310     part[j].uz+=part[j].ux*ty;
<a name="l00311"></a>00311         
<a name="l00312"></a>00312         part[j].ux=ux0-part[j].uz*ty*2.0/(1.0+tabs2);
<a name="l00313"></a>00313     part[j].uz=uz0+part[j].ux*ty*2.0/(1.0+tabs2);
<a name="l00314"></a>00314    }
<a name="l00315"></a>00315 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="82d00e6b66c67491365a66199fe13f8e"></a><!-- doxytag: member="PIC::Boris_uxy" ref="82d00e6b66c67491365a66199fe13f8e" args="(Grid2D &amp;Bx, Grid2D &amp;By, double dt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PIC::Boris_uxy           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classGrid2D.html">Grid2D</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>Bx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classGrid2D.html">Grid2D</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>By</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>dt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Boris particle updater for a B-field in x,y. The push is done in 3D cartesian coordinates. 
<p>Definition at line <a class="el" href="pic_8cpp-source.html#l00261">261</a> of file <a class="el" href="pic_8cpp-source.html">pic.cpp</a>.</p>

<p>References <a class="el" href="Grid_8cpp-source.html#l00440">Grid2D::Grid2PIC()</a>, and <a class="el" href="pic_8h-source.html#l00018">mass_p</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00262"></a>00262 {
<a name="l00263"></a>00263  <span class="keywordtype">long</span> j;        
<a name="l00264"></a>00264  <span class="keywordtype">double</span> tx, ty, tabs2, Bxj, Byj, Babs, u2, gamma, ux0, uy0, uz0;        
<a name="l00265"></a>00265  <span class="keywordflow">for</span>(j=0; j&lt;part.size(); j++)
<a name="l00266"></a>00266    { 
<a name="l00267"></a>00267     Bxj=Bx.<a class="code" href="classGrid2D.html#c25cb1c58d630125856499c665c0a596">Grid2PIC</a>(part[j].x,part[j].y);
<a name="l00268"></a>00268         Byj=By.<a class="code" href="classGrid2D.html#c25cb1c58d630125856499c665c0a596">Grid2PIC</a>(part[j].x,part[j].y); 
<a name="l00269"></a>00269         Babs=sqrt(pow(Bxj,2)+pow(Byj,2));
<a name="l00270"></a>00270         u2=pow(part[j].uy,2)+pow(part[j].ux,2)+pow(part[j].uz,2);
<a name="l00271"></a>00271         gamma=sqrt(1.0+u2/pow(clight,2));
<a name="l00272"></a>00272         ux0=part[j].ux;uy0=part[j].uy;uz0=part[j].uz;
<a name="l00273"></a>00273         <span class="keywordflow">if</span> (Babs &gt; 0.0) {
<a name="l00274"></a>00274                 tx=Bxj/Babs*tan(charge_p*dt*Babs/(2.0*gamma*<a class="code" href="classPIC.html#99e18e7f4ab625cdd446b5b2f9e2e56a" title="particle charge and charge numbers">mass_p</a>));
<a name="l00275"></a>00275                 ty=Byj/Babs*tan(charge_p*dt*Babs/(2.0*gamma*<a class="code" href="classPIC.html#99e18e7f4ab625cdd446b5b2f9e2e56a" title="particle charge and charge numbers">mass_p</a>)); }
<a name="l00276"></a>00276         <span class="keywordflow">else</span> {tx=0.0; ty=0.0;}
<a name="l00277"></a>00277         
<a name="l00278"></a>00278         tabs2=pow(tx,2)+pow(ty,2); 
<a name="l00279"></a>00279         
<a name="l00280"></a>00280         part[j].ux+=-part[j].uz*ty;
<a name="l00281"></a>00281         part[j].uy+=part[j].uz*tx;
<a name="l00282"></a>00282     part[j].uz+=part[j].ux*ty-part[j].uy*tx;
<a name="l00283"></a>00283         
<a name="l00284"></a>00284         part[j].ux=ux0-part[j].uz*ty*2.0/(1.0+tabs2);
<a name="l00285"></a>00285         part[j].uy=uy0+part[j].uz*tx*2.0/(1.0+tabs2);
<a name="l00286"></a>00286     part[j].uz=uz0+part[j].ux*ty*2.0/(1.0+tabs2)-part[j].uy*tx*2.0/(1.0+tabs2);
<a name="l00287"></a>00287    }
<a name="l00288"></a>00288 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="40784574a094f98cbd95fd3729f1ca3b"></a><!-- doxytag: member="PIC::Boris_urz" ref="40784574a094f98cbd95fd3729f1ca3b" args="(Grid2D_rz &amp;Br, Grid2D_rz &amp;Bz, double dt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PIC::Boris_urz           </td>
          <td>(</td>
          <td class="paramtype">Grid2D_rz &amp;&nbsp;</td>
          <td class="paramname"> <em>Br</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Grid2D_rz &amp;&nbsp;</td>
          <td class="paramname"> <em>Bz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>dt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Boris particle updater for a B-field given in cylindrical coordinates. The push is done in 3D cartesian coordinates. 
<p>Definition at line <a class="el" href="pic_8cpp-source.html#l00322">322</a> of file <a class="el" href="pic_8cpp-source.html">pic.cpp</a>.</p>

<p>References <a class="el" href="pic_8h-source.html#l00018">mass_p</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00323"></a>00323 {
<a name="l00324"></a>00324  <span class="keywordtype">long</span> j;        
<a name="l00325"></a>00325  <span class="keywordtype">double</span> tx, ty, tz, tabs2, Bxj, Byj, Bzj, Babs, u2, gamma, ux0, uy0, uz0, rpart;        
<a name="l00326"></a>00326  <span class="keywordflow">for</span>(j=0; j&lt;part.size(); j++)
<a name="l00327"></a>00327    { 
<a name="l00328"></a>00328         rpart=sqrt(pow(part[j].x,2)+pow(part[j].y,2));
<a name="l00329"></a>00329     Bxj=part[j].x/rpart*Br.Grid2PIC(rpart,part[j].z);
<a name="l00330"></a>00330         Byj=part[j].y/rpart*Br.Grid2PIC(rpart,part[j].z);
<a name="l00331"></a>00331         Bzj=Bz.Grid2PIC(rpart,part[j].z);
<a name="l00332"></a>00332         Babs=sqrt(pow(Bxj,2)+pow(Byj,2)+pow(Bzj,2));
<a name="l00333"></a>00333         u2=pow(part[j].uy,2)+pow(part[j].ux,2)+pow(part[j].uz,2);
<a name="l00334"></a>00334         gamma=sqrt(1.0+u2/pow(clight,2));
<a name="l00335"></a>00335         ux0=part[j].ux;uy0=part[j].uy;uz0=part[j].uz;
<a name="l00336"></a>00336         <span class="keywordflow">if</span> (Babs &gt; 0.0) {
<a name="l00337"></a>00337                 tx=Bxj/Babs*tan(charge_p*dt*Babs/(2.0*gamma*<a class="code" href="classPIC.html#99e18e7f4ab625cdd446b5b2f9e2e56a" title="particle charge and charge numbers">mass_p</a>));
<a name="l00338"></a>00338                 ty=Byj/Babs*tan(charge_p*dt*Babs/(2.0*gamma*<a class="code" href="classPIC.html#99e18e7f4ab625cdd446b5b2f9e2e56a" title="particle charge and charge numbers">mass_p</a>)); 
<a name="l00339"></a>00339                 tz=Bzj/Babs*tan(charge_p*dt*Babs/(2.0*gamma*<a class="code" href="classPIC.html#99e18e7f4ab625cdd446b5b2f9e2e56a" title="particle charge and charge numbers">mass_p</a>)); 
<a name="l00340"></a>00340                 }
<a name="l00341"></a>00341         <span class="keywordflow">else</span> {tx=0.0; ty=0.0; tz=0.0;}
<a name="l00342"></a>00342         
<a name="l00343"></a>00343         tabs2=pow(tx,2)+pow(ty,2); 
<a name="l00344"></a>00344         
<a name="l00345"></a>00345         part[j].ux+=part[j].uy*tz-part[j].uz*ty;
<a name="l00346"></a>00346         part[j].uy+=part[j].uz*tx-part[j].ux*tz;
<a name="l00347"></a>00347     part[j].uz+=part[j].ux*ty-part[j].uy*tx;
<a name="l00348"></a>00348         
<a name="l00349"></a>00349         part[j].ux=ux0+(part[j].uy*tz-part[j].uz*ty)*2.0/(1.0+tabs2);
<a name="l00350"></a>00350         part[j].uy=uy0+(part[j].uz*tx-part[j].ux*tz)*2.0/(1.0+tabs2);
<a name="l00351"></a>00351     part[j].uz=uz0+(part[j].ux*ty-part[j].uy*tx)*2.0/(1.0+tabs2);
<a name="l00352"></a>00352    }
<a name="l00353"></a>00353 }
</pre></div>
<p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="pic_8h-source.html">pic.h</a><li><a class="el" href="pic_8cpp-source.html">pic.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Mar 7 14:43:49 2012 for BPHYLIB by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
